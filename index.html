<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>ランプシャッター</title>
<link rel="manifest" href="manifest.json">
<style>
html,body{
  margin:0;
  height:100%;
  background:#061018;
  color:#fff;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
}
.wrap{
  max-width:720px;
  margin:0 auto;
  padding:20px;
  text-align:center;
}
h1{font-size:34px;margin:10px 0 6px}
.sub{opacity:.85;margin-bottom:16px}
.card{
  display:block;
  border-radius:18px;
  overflow:hidden;
  margin:18px 0;
  box-shadow:0 10px 24px rgba(0,0,0,.35);
  transition:transform .15s;
}
.card:active{transform:scale(.97)}
.card img{width:100%;display:block}
.note{opacity:.8;margin-top:8px;font-size:14px;line-height:1.4}
</style>
</head>
<body>
<div class="wrap">
  <h1>ランプシャッター</h1>
  <p class="sub">ここをタップすると判定開始！</p>

  <!-- 昼モード -->
  <a href="day_mode.html" class="card" onclick="LS_preGrant()">
    <img src="assets/hero_day.png" alt="昼モード">
  </a>

  <!-- 夜モード -->
  <a href="night_mode.html" class="card" onclick="LS_preGrant()">
    <img src="assets/hero_night.png" alt="夜モード">
  </a>

  <p class="note">※タップ後にカメラ・保存の許可を求めます（背面カメラ固定／非ミラー）。</p>
</div>

<script>
function LS_preGrant(){
  try {
    localStorage.setItem('LS_USER_TAPPED','1');
    // Safariに操作イベントを与えるためのダミー共有
    const blob = new Blob(["ランプシャッター権限確認"], {type:"text/plain"});
    const file = new File([blob], "grant.txt", {type:"text/plain"});
    if (navigator.canShare && navigator.canShare({ files: [file] })) {
      navigator.share({
        files: [file],
        title: "ランプシャッター",
        text: "保存権限の事前取得"
      }).catch(()=>{});
    }
  } catch(e){}
}
</script>

</body>
</html>
